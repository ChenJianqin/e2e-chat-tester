# 🤖 対話型E2EテストWebアプリ

ブラウザ上のUIで「URL」と「テスト内容（日本語）」を入力 → OpenAI に送信 → Playwright が自動実行 → 結果を画面表示

## ✨ 主要機能

### 🎯 テスト実行機能
- 🌐 **URL入力**: テスト対象のWebサイトのURLを指定
- 📝 **日本語テスト記述**: 自然言語でテスト内容を記述
- 🤖 **AI自動テスト生成**: OpenAI GPT-4oがPlaywrightテストコードを自動生成
- 🎭 **Playwright自動実行**: 生成されたテストを自動実行
- 📸 **スクリーンショット**: テスト実行時の画面をキャプチャ（複数ページ対応）
- 📊 **詳細レポート**: ページ情報、エラーログ、生成コードを表示

### 💾 テスト管理機能
- 📁 **プロジェクト管理**: テストをプロジェクト別に整理・管理
- 💾 **テスト保存**: 生成されたテストコードを永続化
- 🔄 **テスト再実行**: 保存されたテストを簡単に再実行
- ✏️ **コード編集**: 保存されたテストコードを直接編集
- 🗑️ **テスト削除**: 不要なテストの削除
- 📋 **テストケース管理**: ローカルストレージでのテストケース管理

### 🔍 高度なテスト機能
- 🔗 **複数ページテスト**: 自動的にページ遷移を検出して複数ページをテスト
- 🎯 **インテリジェントナビゲーション**: テスト内容に基づいて適切なリンクやボタンを自動選択
- 📱 **レスポンシブ対応**: 様々な画面サイズでのテスト実行
- ⚡ **リアルタイム実行**: テスト実行状況をリアルタイムで表示

## 🚀 セットアップ

### 1. 依存関係のインストール

```bash
npm install
```

### 2. 環境変数の設定

`.env.local` ファイルを作成し、OpenAI APIキーを設定してください：

```bash
OPENAI_API_KEY=your_openai_api_key_here
```

### 3. 開発サーバーの起動

```bash
npm run dev
```

[http://localhost:3000](http://localhost:3000) でアプリケーションにアクセスできます。

## 📖 使用方法

### 基本的なテスト実行
1. **URL入力**: テストしたいWebサイトのURLを入力
2. **テスト内容記述**: 日本語でテストしたい内容を記述
   - 例：「トップページでヘッダーが正しく表示されているか確認」
   - 例：「ログインボタンがクリックできるかテスト」
   - 例：「フォームのバリデーションが正常に動作するか確認」
   - 例：「無料で鑑定ボタンをクリックして次のページに遷移するかテスト」
3. **実行**: 「🚀 テストを実行」ボタンをクリック
4. **結果確認**: スクリーンショット、詳細情報、生成されたコードを確認

### テスト管理
1. **プロジェクト作成**: 「+ 新規プロジェクト」ボタンでプロジェクトを作成
2. **テスト保存**: テスト実行後、「💾 テストコードを保存」ボタンでテストを保存
3. **テスト一覧**: 「💾 保存されたテスト」ボタンで保存されたテストを確認
4. **テスト再実行**: 保存されたテストの「▶️ 実行」ボタンで再実行
5. **コード編集**: 「✏️ 編集」ボタンでテストコードを直接編集

## 🛠️ 技術スタック

- **フロントエンド**: Next.js 15, React 19, TypeScript, Tailwind CSS
- **バックエンド**: Next.js API Routes
- **AI**: OpenAI GPT-4o
- **E2Eテスト**: Playwright
- **リンター**: Biome
- **ファイルシステム**: Node.js fs/promises

## 📁 プロジェクト構造

```
src/
├── app/
│   ├── api/
│   │   ├── run-test/              # 新規テスト実行
│   │   ├── run-saved-test/        # 保存されたテスト実行
│   │   ├── save-test/             # テスト保存
│   │   ├── load-tests/            # テスト一覧取得
│   │   ├── load-test-code/        # テストコード読み込み
│   │   ├── update-test-code/      # テストコード更新
│   │   └── delete-saved-test/     # テスト削除
│   ├── page.tsx                   # メインページ
│   └── layout.tsx                 # レイアウト
tests/
├── project-{projectId}/           # プロジェクト別テスト保存
│   └── test-{testId}/
│       ├── test.spec.ts          # Playwrightテストコード
│       ├── test-config.json      # テスト設定
│       └── screenshots/          # テスト実行時のスクリーンショット
├── test-runner.ts                 # テスト実行エンジン
└── test-patterns/                 # テストパターン集
    ├── button-click-test.ts       # ボタンクリックテスト
    └── form-test.ts               # フォームテスト
public/
└── screenshots/                   # 実行時スクリーンショット保存
```

## 🔧 開発

### リンター実行

```bash
npm run lint
```

### フォーマット

```bash
npm run format
```

### ビルド

```bash
npm run build
```

### 本番起動

```bash
npm start
```

## 🚀 デプロイ

Vercelでのデプロイが推奨されます：

1. GitHubリポジトリにプッシュ
2. Vercelでプロジェクトをインポート
3. 環境変数 `OPENAI_API_KEY` を設定
4. デプロイ完了

## 📋 API エンドポイント

| エンドポイント | メソッド | 説明 |
|---|---|---|
| `/api/run-test` | POST | 新規テストの実行 |
| `/api/run-saved-test` | POST | 保存されたテストの実行 |
| `/api/save-test` | POST | テストコードの保存 |
| `/api/load-tests` | GET | 保存されたテスト一覧の取得 |
| `/api/load-test-code` | GET | 特定のテストコードの取得 |
| `/api/update-test-code` | PUT | テストコードの更新 |
| `/api/delete-saved-test` | DELETE | テストの削除 |

## ⚠️ 注意事項

- OpenAI APIキーが必要です
- テスト実行には時間がかかる場合があります（複数ページテストの場合、最大5ページまで）
- 大量のリクエストはAPI制限に注意してください
- スクリーンショットは `public/screenshots/` ディレクトリに保存されます
- 保存されたテストは `tests/` ディレクトリにプロジェクト別に保存されます

## 🔮 今後の予定

- [ ] テスト結果の履歴管理
- [ ] テスト実行スケジュール機能
- [ ] 複数ブラウザでの並列テスト
- [ ] テスト結果の比較機能
- [ ] CI/CD連携機能
